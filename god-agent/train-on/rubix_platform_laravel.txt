# RUBIX PLATFORM: LARAVEL
# VERSION: 11.x
# FOUNDATION: Symfony_components|PHP_8.2+
# PHILOSOPHY: expressive_elegant_syntax|developer_happiness

==============================================================================
HISTORY
==============================================================================
2011:Taylor_Otwell>created>frustration_with_CodeIgniter
2013:v4>Composer_adoption|IoC_container
2015:v5>directory_restructure|.env|Elixir
2017:v5.5>package_auto_discovery|React_presets
2019:v6>Laravel_Vapor|serverless
2020:v8>Jetstream|model_factory_classes
2022:v9>Symfony_6|PHP_8.0_min
2023:v10>PHP_8.1_min|process_facade
2024:v11>streamlined_structure|per_second_rate_limiting

CORE_MAINTAINERS
Taylor_Otwell:creator|Forge|Vapor|Nova
Dries_Vints:core_team|Laravel.io
Nuno_Maduro:Pest|Collision|Larastan
Mohamed_Said:queue_system|Forge

==============================================================================
SERVICE_CONTAINER_PATTERNS
==============================================================================
BINDING
+bind:new_instance_each_resolve
+singleton:same_instance_always
+scoped:same_within_request|different_across_requests
+instance:bind_existing_object

*app()->bind(Interface::class,Concrete::class)
*app()->singleton(Service::class,fn()=>new Service())
*app()->when(Controller::class)->needs(Interface::class)->give(Impl::class)

CONTEXTUAL_BINDING
+when_same_interface_different_impl_per_consumer
*$this->app->when(PhotoController::class)->needs(Filesystem::class)->give(S3Filesystem::class)

SERVICE_PROVIDER_PATTERN
*register():bind_only|no_other_services
*boot():use_other_services|event_listeners|routes
!never_resolve_in_register|container_not_ready

-service_locator_antipattern:app()->make()_everywhere
+constructor_injection_always

==============================================================================
ELOQUENT_PATTERNS
==============================================================================
GOOD_PATTERNS
+scopes:reusable_query_constraints
*scopeActive($q){return $q->where('active',true)}
*User::active()->recent()->get()

+accessors_mutators:attribute_transformation
*Attribute::make(get:fn($v)=>ucfirst($v),set:fn($v)=>strtolower($v))

+casts:automatic_type_conversion
*protected $casts=['options'=>'array','published_at'=>'datetime']

+eager_loading:prevent_N+1
*User::with(['posts','posts.comments'])->get()
*$this->belongsTo(User::class)->withDefault()

REPOSITORY_PATTERN_IN_LARAVEL
+interface_per_entity
+impl_uses_eloquent
+inject_via_service_provider
*UserRepositoryInterface>EloquentUserRepository
!dont_return_eloquent_models_from_repo|return_DTOs_or_arrays

QUERY_OBJECT_PATTERN
+complex_queries_in_dedicated_class
*GetActiveUsersWithRecentOrders::class
*public function handle():Collection

ANTI_PATTERNS
-fat_models:1000+LOC|mixed_concerns
-query_in_views:blade_calling_DB
-N+1:loop_without_eager_load
*detect:debugbar|telescope|laravel-query-detector
-raw_queries_everywhere:lose_eloquent_benefits
-touching_$attributes_directly:bypass_casts_accessors

==============================================================================
CONTROLLER_PATTERNS
==============================================================================
GOOD_PATTERNS
+single_action_controllers:__invoke
*Route::get('/dashboard',DashboardController::class)
+resource_controllers:7_RESTful_methods
+form_request_validation:separate_class
*public function store(StoreUserRequest $request)

+action_classes:complex_business_logic
*app/Actions/CreateUser.php
*public function execute(array $data):User

SERVICE_CLASS_PATTERN
+app/Services/UserService.php
+inject_into_controller
+single_responsibility
*public function createWithTeam(array $userData,array $teamData):User

ANTI_PATTERNS
-fat_controllers:100+LOC_per_method
-validation_in_controller:use_FormRequest
-direct_model_in_controller:complex_ops
-business_logic_in_controller:extract_to_service_or_action

DETECTION_FAT_CONTROLLER
*multiple_model_operations
*complex_conditionals
*transaction_handling
*event_dispatching
*notification_sending
>extract_to_Service|Action|Job

==============================================================================
ARCHITECTURE_PATTERNS
==============================================================================
STANDARD_STRUCTURE
app/Http/Controllers|Middleware|Requests
app/Models
app/Services
app/Actions
app/Jobs
app/Events|Listeners
app/Policies
app/Providers

DOMAIN_DRIVEN_STRUCTURE
app/Domain/User/Models|Actions|Events|Policies
app/Domain/Order/Models|Actions|Events|Policies
app/Support/helpers|traits

MODULAR_STRUCTURE
modules/User/Http|Models|Services|Routes|Views
modules/Order/Http|Models|Services|Routes|Views
*nwidart/laravel-modules_package

==============================================================================
QUEUE_JOB_PATTERNS
==============================================================================
GOOD_PATTERNS
+ShouldQueue:async_processing
+job_chaining:Bus::chain([])
+job_batching:Bus::batch([])
+rate_limiting:Redis::throttle()
+unique_jobs:ShouldBeUnique
+job_middleware:RateLimited|WithoutOverlapping

*class ProcessPodcast implements ShouldQueue
*public $tries=3
*public $backoff=[1,5,10]
*public $timeout=120

ANTI_PATTERNS
-large_payload:serialize_id_only|fetch_in_handle
-no_failure_handling:implement_failed()
-silent_failures:log|notify|dead_letter
-sync_heavy_work:queue_it

==============================================================================
EVENT_PATTERNS
==============================================================================
GOOD_PATTERNS
+domain_events:UserRegistered|OrderPlaced
+event_subscribers:grouped_listeners
+model_events:creating|created|updating|deleted
+observers:dedicated_model_event_class

EVENT_SOURCING_LITE
+spatie/laravel-event-sourcing
*StoredEvent|Projector|Reactor|AggregateRoot

ANTI_PATTERNS
-event_listener_doing_too_much:chain_events
-sync_listeners_for_slow_ops:ShouldQueue
-circular_events:A>B>A

==============================================================================
TESTING_PATTERNS
==============================================================================
GOOD_PATTERNS
+feature_tests:HTTP_testing|full_stack
+unit_tests:isolated_class_testing
+pest_syntax:cleaner_than_phpunit
*it('creates_user',fn()=>...)
+database_transactions:RefreshDatabase
+factories:model_state_builders
*User::factory()->withPosts(3)->create()
+mocking:Mockery|partial_mocks
*$this->mock(PaymentGateway::class)
+fakes:Mail::fake()|Queue::fake()|Event::fake()

ANTI_PATTERNS
-testing_framework_not_app:assert_laravel_works
-no_factories:manual_model_creation
-testing_private_methods:test_public_interface
-slow_tests:optimize_db_setup

==============================================================================
SECURITY_PATTERNS
==============================================================================
GOOD
+mass_assignment_protection:$fillable|$guarded
+authorization:Gate|Policy
*Gate::allows('update',$post)
*$this->authorize('update',$post)
+validation:FormRequest|validate()
+csrf:@csrf|VerifyCsrfToken_middleware
+sql_injection_prevention:eloquent_bindings
+xss:{{$var}}|blade_auto_escapes
+rate_limiting:RateLimiter::for()

BAD
-$guarded=[]:everything_fillable
-raw_queries_with_user_input
-{!!$var!!}:raw_unescaped
-disabled_csrf
-storing_secrets_in_code:use_.env

==============================================================================
PERFORMANCE_PATTERNS
==============================================================================
GOOD
+config:cache|route:cache|view:cache
+eager_loading:with()
+chunking:chunk()|cursor()|lazy()
+caching:Cache::remember()
+database_indexing:migrations
+queue_for_heavy_ops
+octane:swoole|roadrunner

BAD
-N+1_queries:use_eager_load
-cache_entire_pages:cache_specific
-large_collections_in_memory:chunk|cursor
-sync_external_api_calls:queue

DETECTION_N+1
*laravel-debugbar:query_count
*telescope:query_tab
*laravel-query-detector:auto_warn
*clockwork:profiling

==============================================================================
PACKAGE_PATTERNS
==============================================================================
ESSENTIAL_PACKAGES
spatie/laravel-permission:roles_permissions
spatie/laravel-medialibrary:file_uploads
spatie/laravel-activitylog:audit
barryvdh/laravel-debugbar:debug
nunomaduro/larastan:static_analysis
pestphp/pest:testing

INTERNAL_PACKAGE_PATTERN
+packages/internal-package/src
+composer_path_repository
*"repositories":[{"type":"path","url":"packages/*"}]

==============================================================================
COMMON_SMELLS
==============================================================================
SMELL                    | DETECTION                        | FIX
------------------------|----------------------------------|------------------
Fat_Controller          | 100+LOC_method|many_deps        | Service|Action
Fat_Model               | 1000+LOC|mixed_concerns          | Traits|Services
N+1_Query               | loop_with_relation_access        | with()_eager
God_Service             | many_public_methods              | split_by_concern
No_Validation           | direct_$request->all()           | FormRequest
Raw_SQL                 | DB::raw_with_user_input          | bindings|eloquent
Missing_Index           | slow_where_clauses               | add_migration_index
Sync_Heavy_Work         | HTTP_timeout_risk                | dispatch_job
